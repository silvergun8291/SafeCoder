version: '3.8'

# 공유 볼륨 정의
volumes:
  scanner_source:
  scanner_results:

services:
  bandit:
    build: ./scanners/bandit
    image: custom/bandit:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["python"]

  dlint:
    build: ./scanners/dlint
    image: custom/dlint:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["python"]

  semgrep:
    image: returntocorp/semgrep:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["both"]
    command: ["scan", "--config=auto", "/source", "--json", "-o", "/results/semgrep_result.json"]

  codeql:
    image: mcr.microsoft.com/cstsectools/codeql-container:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["both"]

  horusec:
    image: horuszup/horusec-cli:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["java"]

  spotbugs:
    build: ./scanners/spotbugs
    image: custom/spotbugs:latest
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["java"]

  joern:
    image: ghcr.io/joernio/joern:nightly
    volumes:
      - scanner_source:/source:ro
      - scanner_results:/results
    profiles: ["cpg"]
