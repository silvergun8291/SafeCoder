rules:
- id: java-os-command-injection
  message: 'Avoid string concatenation in Runtime.exec() to prevent OS command injection.
    Use ProcessBuilder with argument array and input validation instead.

    '
  severity: ERROR
  languages:
  - java
  metadata:
    cwe: CWE-78
    owasp: A01:2021 - Broken Access Control
    source-rule: https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html
    rationale: 'String concatenation in Runtime.exec() is vulnerable to OS command
      injection.

      Attackers can inject malicious commands through untrusted input.

      Use ProcessBuilder with argument array and input validation to prevent this.

      '
  fix: ProcessBuilder processBuilder = new ProcessBuilder($CMD, $INPUT);
  pattern-inside: |
    public * executeCommand(String $INPUT) throws *
  pattern: Runtime.getRuntime().exec($CMD + $INPUT);