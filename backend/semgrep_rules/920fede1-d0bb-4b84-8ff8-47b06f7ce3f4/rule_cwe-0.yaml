rules:
  - id: java-sql-injection-prepared-statement
    message: Use PreparedStatement with bind parameters to prevent SQL injection.
    severity: ERROR
    languages: [java]
    metadata:
      category: "Security"
      technology: ["java.sql"]
    pattern-inside: |
      public void $METHOD(...) {
        ...
      }
    pattern: |
      Statement $STMT = $CONNECTION.createStatement();
      $STMT.executeQuery($QUERY);
    fix: |
      PreparedStatement $STMT = $CONNECTION.prepareStatement($QUERY);
      $STMT.setString(...);
      $STMT.executeQuery();
    fix-regex:
      regex:
        - $QUERY
      replacements:
        - $QUERY
      fix-regex-pattern: |
        PreparedStatement $STMT = $CONNECTION.prepareStatement($QUERY);
        $STMT.setString(...);
        $STMT.executeQuery();